<html>
    <head>
        <meta charset="utf-8">
        <script src="http://libs.baidu.com/jquery/1.9.0/jquery.js"></script>
        <!-- é€šè¿‡æ ‡ç­¾æ–¹å¼ç›´æ¥å¼•ç”¨æ„å»ºå¥½çš„echartsæ–‡ä»¶ -->
        <script src='js/echarts.min.js'></script>
        <script src='js/echarts-wordcloud.js'></script>
    </head>
    <body>
        <style>
            html, body,#main{
                width: 100%;
                height: 100%;
                margin: 0;
            }
        </style>
        <!-- å®šä¹‰ä¸€ä¸ªå…·å¤‡å®½é«˜çš„DOMå®¹å™¨ï¼Œç”¨æ¥è£…è¯äº‘ -->
        <div id='main'></div>
        <script type="text/javascript">
            // åŸºäºæŒ‡å®šå¥½çš„DOMï¼Œé€šè¿‡echarts.initæ–¹æ³•åˆå§‹åŒ–ä¸€ä¸ªechartså®ä¾‹
            var chart = echarts.init(document.getElementById('main'));
            // console.log(chart);
            // æŒ‡å®šè¯äº‘å›¾çš„é…ç½®é¡¹å’Œæ•°æ®
            var option = {
                // ç»™è¯äº‘å›¾æ·»åŠ ä¸€ä¸ªæ ‡é¢˜ï¼Œä½†æ˜¯æˆ‘ä¸æ™“å¾—æ€ä¹ˆå®šä¹‰æ ·å¼æˆ–è€…ç§»åŠ¨ä½ç½®
                title:{
                    text:'è…¾è®¯è§†é¢‘ã€Šåœ¨ä¸€èµ·ã€‹è¯„è®ºè¯äº‘å›¾'
                },
                tooltip: {},

                series: [ {
                    type: 'wordCloud',
                    gridSize: 2,
                    sizeRange: [12, 50],
                    rotationRange: [-90, 90],
                    shape: 'pentagon',
                    width: 600,
                    height: 400,
                    drawOutOfBound: true,
                    textStyle: {
                        color: function () {
                            return 'rgb(' + [
                                Math.round(Math.random() * 160),
                                Math.round(Math.random() * 160),
                                Math.round(Math.random() * 160)
                            ].join(',') + ')';
                        }
                    },
                    emphasis: {
                        textStyle: {
                            shadowBlur: 10,
                            shadowColor: '#333'
                        }
                    },
                    data: []
                } ]
            };
            chart.setOption(option);

            window.onload = function(){
                var url = 'resultData.json';
                var request = new XMLHttpRequest();
                request.open("get",url);
                request.send(null);
                request.onload = function(){
                    // echartsä¸­çš„dataå®é™…ä¸Šæ˜¯ä¸€ä¸ªjsonnarrayå¯¹è±¡ï¼Œæ‰€ä»¥è¿”å›ä¸€ä¸ªjsonæ•°ç»„å³å¯å®ç°åŠ¨æ€åŠ è½½
                    var jsonObj = new Array();
                    if (request.status == 200) {                        
                        // console.log(request);
                        // console.log(request.responseText)

                        //å°†è·å–çš„jsonæ•°æ®èµ‹å€¼ç»™data_json
                        var data_json = request.responseText;
                        //è½¬æ¢æˆjsonå¯¹è±¡
                        var obj = eval("("+data_json+")");
                        // console.log(obj[0])
                        for (var i = 0; i < obj.length; i++) {
                            jsonObj.push({
                                "name":obj[i].name,
                                "value":Number(obj[i].value)
                            });
                        }
                        // console.log(jsonObj);
                        chart.setOption({
                            series:[{
                                type:'wordCloud',
                                data:jsonObj
                            }]
                        });               
                    }
                }
            }
            // çª—å£è‡ªé€‚åº”
            window.onresize = chart.resize;



            // ajaxæœ‰ç‚¹å°bugï¼Œæœ‰å…´è¶£çš„å¯ä»¥è¯•è¯•æ‰¾ä¸€æ‰¾ï¼Œæˆ‘æ˜¯ä¸æäº†ğŸ˜
            // $.ajax({
            //     // æœ¬åœ°çš„å°±å†™æœ¬åœ°çš„ä½ç½®ï¼Œå¦‚æœæ˜¯æœåŠ¡å™¨çš„å°±å†™æœåŠ¡å™¨çš„è·¯å¾„
            //     url:'resultData.json',
            //     type:'get',  //è·å–æ•°æ®æ–¹å¼ä¸ºget
            //     dataType:'json', //æ•°æ®ç±»å‹ä¸ºjson
            //     success: function(data){
            //         //å°†josnæ•°æ®è½¬æ¢
            //         dd = eval("("+data+")")
            //         //è¯·æ±‚æˆåŠŸååœ¨é¡µé¢åŠ è½½æ—¶æ‰§è¡Œå‡½æ•°
            //         window.onload = function(){
            //             var keyWordlist = [];
            //             for (var i = 0; i < dd.length; i++) {
            //                 keyWordlist.push({
            //                     'name': data[i].name,
            //                     'value': data[i].value
            //                 })
            //             }
            //             // å°†æ•°æ®åŠ è½½åˆ°äº‹å…ˆè®¾ç½®å¥½çš„å˜é‡data[]
            //             chart.setOption({
            //                 series:[{
            //                     type: 'wordCloud',
            //                     data: keyWordlist,
            //                 }]
            //             });
            //         }

            //     }
            // });
            
        </script>

    </body>
</html>